!function(l,h){"use strict";function o(t,i){var n;this.$input=l(t),this.$rating=l("<span></span>").css({cursor:"default"}).insertBefore(this.$input),this.options=((n=l.extend({},this.$input.data(),i)).start=parseInt(n.start,10),n.start=isNaN(n.start)?h:n.start,n.stop=parseInt(n.stop,10),n.stop=isNaN(n.stop)?n.start+5||h:n.stop,n.step=parseInt(n.step,10)||h,n.fractions=Math.abs(parseInt(n.fractions,10))||h,n.scale=Math.abs(parseInt(n.scale,10))||h,(n=l.extend({},l.fn.rating.defaults,n)).filledSelected=n.filledSelected||n.filled,n),this._init()}o.prototype={_init:function(){for(var e=this,n=this.$input,t=this.$rating,i=function(i){return function(t){n.prop("disabled")||n.prop("readonly")||n.data("readonly")!==h||i.call(this,t)}},s=1;s<=this._rateToIndex(this.options.stop);s++){var o=l('<div class="rating-symbol"></div>').css({display:"inline-block",position:"relative"});l('<div class="rating-symbol-background '+this.options.empty+'"></div>').appendTo(o),l('<div class="rating-symbol-foreground"></div>').append('<span class="'+this.options.filled+'"></span>').css({display:"inline-block",position:"absolute",overflow:"hidden",left:0,right:0,width:0}).appendTo(o),t.append(o),this.options.extendSymbol.call(o,this._indexToRate(s))}this._updateRate(n.val()),n.on("change",function(){e._updateRate(l(this).val())});function a(t){var i=l(t.currentTarget),n=Math.abs((t.pageX||t.originalEvent.touches[0].pageX)-(("rtl"===i.css("direction")&&i.width())+i.offset().left));return n=0<n?n:.1*e.options.scale,i.index()+n/i.width()}var r;t.on("mousedown touchstart",".rating-symbol",i(function(t){n.val(e._indexToRate(a(t))).change()})).on("mousemove touchmove",".rating-symbol",i(function(t){var i=e._roundToFraction(a(t));i!==r&&(r!==h&&l(this).trigger("rating.rateleave"),r=i,l(this).trigger("rating.rateenter",[e._indexToRate(r)])),e._fillUntil(i)})).on("mouseleave touchend",".rating-symbol",i(function(){r=h,l(this).trigger("rating.rateleave"),e._fillUntil(e._rateToIndex(parseFloat(n.val())))}))},_fillUntil:function(t){var i=this.$rating,n=Math.floor(t);i.find(".rating-symbol-background").css("visibility","visible").slice(0,n).css("visibility","hidden");var e=i.find(".rating-symbol-foreground");e.width(0),e.slice(0,n).width("auto").find("span").attr("class",this.options.filled),e.eq(t%1?n:n-1).find("span").attr("class",this.options.filledSelected),e.eq(n).width(t%1*100+"%")},_indexToRate:function(t){return this.options.start+Math.floor(t)*this.options.step+this.options.step*this._roundToFraction(t%1)},_rateToIndex:function(t){return(t-this.options.start)/this.options.step},_roundToFraction:function(t){var i=Math.ceil(t%1*this.options.fractions)/this.options.fractions,n=Math.pow(10,this.options.scale);return Math.floor(t)+Math.floor(i*n)/n},_contains:function(t){var i=0<this.options.step?this.options.start:this.options.stop,n=0<this.options.step?this.options.stop:this.options.start;return i<=t&&t<=n},_updateRate:function(t){var i=parseFloat(t);this._contains(i)?(this._fillUntil(this._rateToIndex(i)),this.$input.val(i)):""===t&&(this._fillUntil(0),this.$input.val(""))},rate:function(t){if(t===h)return this.$input.val();this._updateRate(t)}},l.fn.rating=function(n){var e,s=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=l(this),i=t.data("rating");i||t.data("rating",i=new o(this,n)),"string"==typeof n&&"_"!==n[0]&&(e=i[n].apply(i,s))}),e!==h?e:this},l.fn.rating.defaults={filled:"glyphicon glyphicon-star",filledSelected:h,empty:"glyphicon glyphicon-star-empty",start:0,stop:5,step:1,fractions:1,scale:3,extendSymbol:function(t){}},l(function(){l("input.rating").rating()})}(jQuery),function(e){"use strict";var s,o="emotionsRating",a={bgEmotion:"happy",emotionsCollection:["angry","disappointed","meh","happy","inlove"],count:5,color:"#d0a658;",emotionSize:30,inputName:"ratings[]",emotionOnUpdate:null,ratingCode:5,disabled:!1},r={angry:"&#x1F620;",disappointed:"&#x1F61E;",meh:"&#x1F610;",happy:"&#x1F60A;",smile:"&#x1F603;",wink:"&#x1F609;",laughing:"&#x1F606;",inlove:"&#x1F60D;",heart:"&#x2764;",crying:"&#x1F622;",star:"&#x2B50;",poop:"&#x1F4A9;",cat:"&#x1F63A;",like:"&#x1F44D;",dislike:"&#x1F44E;"};function i(t,i){this.element=t,this.settings=e.extend({},a,i),this.$el=e(t),this.$el.data(name,this),this._defaults=a,this._name=o;var n=this.$el.data(name+"-opts");this.opts=e.extend(this._defaults,i,n),this.containerCode=this.$el.attr("id"),this.elementContainer=e(t),this.styleCode="emotion-style-"+this.containerCode,this.containerCode="emotion-container-"+this.containerCode,this.code="emoji-rating-"+this.containerCode,this.clicked=[],this.clicked[this.containerCode]=!1,this.init()}e.extend(i.prototype={init:function(){s=e(this.element),this.count=0,this.emotionStyle(),this.renderEmotion(),this.manageHover(),this.manageClick()},emotionStyle:function(){var t="."+this.styleCode+"{margin-right:3px;border-radius: 50%;cursor:pointer;opacity:0.3;display: inline-block;font-size:"+this.settings.emotionSize+"px; text-decoration:none;line-height:0.9;text-align: center;color:"+this.settings.color+"}";s.append("<style>"+t+"</style>")},renderEmotion:function(){for(var t=this.settings.count,i=r[this.settings.bgEmotion],n="<div class='"+this.containerCode+"'>",e=1;e<=t;e++)n+="<div class='"+this.styleCode+"' data-index='"+e+"'>"+i+"</div>";n+="</div>",s.append(n),0<this.settings.initialRating&&this.initalRate(this.settings.initialRating)},clearEmotion:function(i){this.settings.disabled||this.elementContainer.find("."+this.styleCode).each(function(){e(this).css("opacity",.3);var t=r[i];e(this).html(t)})},showEmotion:function(t){this.clearEmotion(this.settings.bgEmotion);for(var i=l(this.settings.emotions,t),n=0;n<t;n++)this.elementContainer.find("."+this.styleCode).eq(n).css("opacity",1),this.elementContainer.find("."+this.styleCode).eq(n).html(i)},manageHover:function(){if(!this.settings.disabled){var i=this;this.elementContainer.on({mouseenter:function(){var t=parseInt(e(this).data("index"),10);i.clicked[i.containerCode]||i.showEmotion(t)},mouseleave:function(){i.clicked[i.containerCode]||i.clearEmotion()}},"."+this.styleCode)}},manageClick:function(){if(!this.settings.disabled){var n=this;this.elementContainer.on("click","."+this.styleCode,function(){var t=e(this).data("index"),i=parseInt(t,10);n.showEmotion(i),n.count=i,n.clicked[n.containerCode]?n.updateInput(i):(n.updateInput(i),n.clicked[n.containerCode]=!0),e.isFunction(n.settings.onUpdate)&&n.settings.onUpdate.call(n,i)})}},initalRate:function(t){var i=this;i.showEmotion(t),i.clicked[i.containerCode]||(i.appendInput(t),i.clicked[i.containerCode]=!0)},appendInput:function(t){var i="<input type='hidden' class='"+this.code+" validate-rating' name='"+this.settings.inputName+"' value='"+t+"' />";this.elementContainer.append(i)},updateInput:function(t){this.elementContainer.find("input."+this.code).val(t)}}),e.fn[o]=function(t){return this.each(function(){e.data(this,"plugin_"+o)||e.data(this,"plugin_"+o,new i(this,t))})};var l=function(t,i){return 1==t.length?r[t[0]]:r[t[i-1]]}}(jQuery,document,window);