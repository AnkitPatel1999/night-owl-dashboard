if($.fn.editableTableWidget=function(l){"use strict";return $(this).each(function(){function i(t){(d=o.find("td:focus")).length&&(s.val(d.text()).removeClass("error").show().offset(d.offset()).css(d.css(e.cloneProperties)).width(d.width()).height(d.height()).focus(),t&&s.select())}function n(){var t,e=s.val(),n=$.Event("change");if(d.text()===e||s.hasClass("error"))return!0;t=d.html(),d.text(e).trigger(n,e),!1===n.result&&d.html(t)}function a(t,e){return 39===e?t.next("td"):37===e?t.prev("td"):38===e?t.parent().prev().children().eq(t.index()):40===e?t.parent().next().children().eq(t.index()):[]}var d,t,e=$.extend(((t=$.extend({},$.fn.editableTableWidget.defaultOptions)).editor=t.editor.clone(),t),l),o=$(this),s=e.editor.css("position","absolute").hide().appendTo(o.parent());s.blur(function(){n(),s.hide()}).keydown(function(t){if(13===t.which)n(),s.hide(),d.focus(),t.preventDefault(),t.stopPropagation();else if(27===t.which)s.val(d.text()),t.preventDefault(),t.stopPropagation(),s.hide(),d.focus();else if(9===t.which)d.focus();else if(this.selectionEnd-this.selectionStart===this.value.length){var e=a(d,t.which);0<e.length&&(e.focus(),t.preventDefault(),t.stopPropagation())}}).on("input paste",function(){var t=$.Event("validate");d.trigger(t,s.val()),!1===t.result?s.addClass("error"):s.removeClass("error")}),o.on("click keypress dblclick",i).css("cursor","pointer").keydown(function(t){var e=!0,n=a($(t.target),t.which);0<n.length?n.focus():13===t.which?i(!1):e=((17===t.which||91===t.which||93===t.which)&&i(!0),!1),e&&(t.stopPropagation(),t.preventDefault())}),o.find("td").prop("tabindex",1),$(window).on("resize",function(){s.is(":visible")&&s.offset(d.offset()).width(d.width()).height(d.height())})})},$.fn.editableTableWidget.defaultOptions={cloneProperties:["padding","padding-top","padding-bottom","padding-left","padding-right","text-align","font","font-size","font-family","font-weight","border","border-top","border-bottom","border-left","border-right"],editor:$("<input>")},$.fn.numericInputExample=function(){"use strict";var i=$(this),a=i.find("tfoot tr"),t=i.find("tbody tr");return i.find("td").on("change",function(t){var e=$(this).index(),n=0;if(0!==e){if(i.find("tbody tr").each(function(){var t=$(this);n+=parseFloat(t.children().eq(e).text())}),1===e&&5e3<n)return $(".alert").show(),!1;$(".alert").hide(),a.children().eq(e).text(n)}}).on("validate",function(t,e){return 0===$(this).index()?!!e&&0<e.trim().length:!isNaN(parseFloat(e))&&isFinite(e)}),function(){var e,n;for(e=1;e<a.children().size();e++)n=0,t.each(function(){var t=$(this);n+=parseFloat(t.children().eq(e).text())}),a.children().eq(e).text(n)}(),this},"undefined"==typeof jQuery)throw new Error("Tabledit requires jQuery library.");!function(f){"use strict";f.fn.Tabledit=function(t){if(!this.is("table"))throw new Error("Tabledit only works when applied to a table.");var o=this,e={url:window.location.href,inputClass:"form-control input-sm",toolbarClass:"btn-toolbar",groupClass:"btn-group btn-group-sm",dangerClass:"danger",warningClass:"warning",mutedClass:"text-muted",eventType:"click",rowIdentifier:"id",hideIdentifier:!1,autoFocus:!0,editButton:!0,deleteButton:!0,saveButton:!0,restoreButton:!0,buttons:{edit:{class:"btn btn-sm btn-light",html:'<span class="fal fa-pencil"></span>',action:"edit"},delete:{class:"btn btn-sm btn-light",html:'<span class="fal fa-trash-alt text-danger"></span>',action:"delete"},save:{class:"btn btn-sm btn-primary",html:"Save"},restore:{class:"btn btn-sm btn-warning",html:"Restore",action:"restore"},confirm:{class:"btn btn-sm btn-danger",html:"Confirm"}},onDraw:function(){},onSuccess:function(){},onFail:function(){},onAlways:function(){},onAjax:function(){}},s=f.extend(!0,e,t),a="undefined",d="undefined",n={identifier:function(){s.hideIdentifier&&o.find("th:nth-child("+parseInt(s.columns.identifier[0])+"1), tbody td:nth-child("+parseInt(s.columns.identifier[0])+"1)").hide(),o.find("tbody td:nth-child("+(parseInt(s.columns.identifier[0])+1)+")").each(function(){var t='<span class="tabledit-span tabledit-identifier">'+f(this).text()+"</span>",e='<input class="tabledit-input tabledit-identifier" type="hidden" name="'+s.columns.identifier[1]+'" value="'+f(this).text()+'" disabled>';f(this).html(t+e),f(this).parent("tr").attr(s.rowIdentifier,f(this).text())})},editable:function(){for(var e=0;e<s.columns.editable.length;e++){o.find("tbody td:nth-child("+(parseInt(s.columns.editable[e][0])+1)+")").each(function(){var n=f(this).text();s.editButton||f(this).css("cursor","pointer");var t='<span class="tabledit-span">'+n+"</span>";if(void 0!==s.columns.editable[e][2]){var i='<select class="tabledit-input '+s.inputClass+'" name="'+s.columns.editable[e][1]+'" style="display: none;" disabled>';f.each(jQuery.parseJSON(s.columns.editable[e][2]),function(t,e){i+=n===e?'<option value="'+t+'" selected>'+e+"</option>":'<option value="'+t+'">'+e+"</option>"}),i+="</select>"}else i='<input class="tabledit-input '+s.inputClass+'" type="text" name="'+s.columns.editable[e][1]+'" value="'+f(this).text()+'" style="display: none;" disabled>';f(this).html(t+i),f(this).addClass("tabledit-view-mode")})}},toolbar:function(){if(s.editButton||s.deleteButton){var t="",e="",n="",i="",a="";0===o.find("th.tabledit-toolbar-column").length&&o.find("tr:first").append('<th class="tabledit-toolbar-column"></th>'),s.editButton&&(t='<button type="button" class="tabledit-edit-button '+s.buttons.edit.class+'" style="float: none; margin: 5px;">'+s.buttons.edit.html+"</button>"),s.deleteButton&&(e='<button type="button" class="tabledit-delete-button '+s.buttons.delete.class+'" style="float: none; margin: 5px;">'+s.buttons.delete.html+"</button>",a='<button type="button" class="tabledit-confirm-button '+s.buttons.confirm.class+'" style="display: none; margin: 5px; float: none;">'+s.buttons.confirm.html+"</button>"),s.editButton&&s.saveButton&&(n='<button type="button" class="tabledit-save-button '+s.buttons.save.class+'" style="display: none; float: none; margin: 5px;">'+s.buttons.save.html+"</button>"),s.deleteButton&&s.restoreButton&&(i='<button type="button" class="tabledit-restore-button '+s.buttons.restore.class+'" style="display: none; float: none; margin: 5px;">'+s.buttons.restore.html+"</button>");var d='<div class="tabledit-toolbar '+s.toolbarClass+'" style="text-align: left;">\n                                           <div class="'+s.groupClass+'" style="float: none;">'+t+e+"</div>\n                                           "+n+"\n                                           "+a+"\n                                           "+i+"\n                                       </div></div>";o.find("tbody>tr").append('<td style="white-space: nowrap; width: 15%;">'+d+"</td>")}}},i=function(t){var e=f(t).parent("tr");f(t).parent("tr").find(".tabledit-input.tabledit-identifier").prop("disabled",!0),f(t).find(".tabledit-input").blur().hide().prop("disabled",!0),f(t).find(".tabledit-span").show(),f(t).addClass("tabledit-view-mode").removeClass("tabledit-edit-mode"),s.editButton&&(e.find("button.tabledit-save-button").hide(),e.find("button.tabledit-edit-button").removeClass("active").blur())},l=function(t){b.reset(t);var e=f(t).parent("tr");e.find(".tabledit-input.tabledit-identifier").prop("disabled",!1),f(t).find(".tabledit-span").hide();var n=f(t).find(".tabledit-input");n.prop("disabled",!1).show(),s.autoFocus&&n.focus(),f(t).addClass("tabledit-edit-mode").removeClass("tabledit-view-mode"),s.editButton&&(e.find("button.tabledit-edit-button").addClass("active"),e.find("button.tabledit-save-button").show())},r=function(t){f(t).each(function(){var t=f(this).find(".tabledit-input"),e=f(this).find(".tabledit-span").text();t.is("select")?t.find("option").filter(function(){return f.trim(f(this).text())===e}).attr("selected",!0):t.val(e),i(this)})},u=function(t){!1!==c(s.buttons.edit.action)&&(f(t).each(function(){var t=f(this).find(".tabledit-input");t.is("select")?f(this).find(".tabledit-span").text(t.find("option:selected").text()):f(this).find(".tabledit-span").text(t.val()),i(this)}),a=f(t).parent("tr"))},b={reset:function(t){o.find(".tabledit-confirm-button").hide(),o.find(".tabledit-delete-button").removeClass("active").blur()},submit:function(t){b.reset(t),f(t).parent("tr").find("input.tabledit-identifier").attr("disabled",!1);var e=c(s.buttons.delete.action);if(f(t).parents("tr").find("input.tabledit-identifier").attr("disabled",!0),!1!==e){f(t).parent("tr").addClass("tabledit-deleted-row"),f(t).parent("tr").addClass(s.mutedClass).find(".tabledit-toolbar button:not(.tabledit-restore-button)").attr("disabled",!0),f(t).find(".tabledit-restore-button").show(),d=f(t).parent("tr");var n=f(t).parent().parent().children().index(f(t).parent("tr"))+1;document.getElementById("my-table").deleteRow(n)}},confirm:function(t){o.find("td.tabledit-edit-mode").each(function(){r(this)}),f(t).find(".tabledit-delete-button").addClass("active"),f(t).find(".tabledit-confirm-button").show()},restore:function(t){f(t).parent("tr").find("input.tabledit-identifier").attr("disabled",!1);var e=c(s.buttons.restore.action);f(t).parents("tr").find("input.tabledit-identifier").attr("disabled",!0),!1!==e&&(f(t).parent("tr").removeClass("tabledit-deleted-row"),f(t).parent("tr").removeClass(s.mutedClass).find(".tabledit-toolbar button").attr("disabled",!1),f(t).find(".tabledit-restore-button").hide(),f(t).parent("tr"))}};function c(i){var t=o.find(".tabledit-input").serialize();if(!t)return!1;if(t+="&action="+i,!1===s.onAjax(i,t))return!1;var e=f.post(s.url,t,function(t,e,n){i===s.buttons.edit.action&&(a.removeClass(s.dangerClass).addClass(s.warningClass),setTimeout(function(){o.find("tr."+s.warningClass).removeClass(s.warningClass)},1400)),s.onSuccess(t,e,n)},"json");return e.fail(function(t,e,n){i===s.buttons.delete.action?(d.removeClass(s.mutedClass).addClass(s.dangerClass),d.find(".tabledit-toolbar button").attr("disabled",!1),d.find(".tabledit-toolbar .tabledit-restore-button").hide()):i===s.buttons.edit.action&&a.addClass(s.darkClass),s.onFail(t,e,n)}),e.always(function(){s.onAlways()}),e}return n.identifier(),n.editable(),n.toolbar(),s.onDraw(),s.deleteButton&&(o.on("click","button.tabledit-delete-button",function(t){if(!0!==t.handled){t.preventDefault();var e=f(this).hasClass("active"),n=f(this).parents("td");b.reset(n),e||b.confirm(n),t.handled=!0}}),o.on("click","button.tabledit-confirm-button",function(t){if(!0!==t.handled){t.preventDefault();var e=f(this).parents("td");b.submit(e),t.handled=!0}})),s.restoreButton&&o.on("click","button.tabledit-restore-button",function(t){!0!==t.handled&&(t.preventDefault(),b.restore(f(this).parents("td")),t.handled=!0)}),s.editButton?(o.on("click","button.tabledit-edit-button",function(t){if(!0!==t.handled){t.preventDefault();var e=f(this),n=e.hasClass("active");r(o.find("td.tabledit-edit-mode")),n||f(e.parents("tr").find("td.tabledit-view-mode").get().reverse()).each(function(){l(this)}),t.handled=!0}}),o.on("click","button.tabledit-save-button",function(t){!0!==t.handled&&(t.preventDefault(),u(f(this).parents("tr").find("td.tabledit-edit-mode")),t.handled=!0)})):(o.on(s.eventType,"tr:not(.tabledit-deleted-row) td.tabledit-view-mode",function(t){!0!==t.handled&&(t.preventDefault(),r(o.find("td.tabledit-edit-mode")),l(this),t.handled=!0)}),o.on("change","select.tabledit-input:visible",function(t){!0!==t.handled&&(u(f(this).parent("td")),t.handled=!0)}),f(document).on("click",function(t){var e=o.find(".tabledit-edit-mode");e.is(t.target)||0!==e.has(t.target).length||r(o.find(".tabledit-input:visible").parent("td"))})),o.on("keyup",function(t){var e=o.find(".tabledit-input:visible"),n=o.find(".tabledit-confirm-button");if(0<e.length)var i=e.parents("td");else{if(!(0<n.length))return;i=n.parents("td")}switch(t.keyCode){case 9:s.editButton||(u(i),l(i.closest("td").next()));break;case 13:u(i);break;case 27:r(i),b.reset(i)}}),this}}(jQuery),$(function(){$("#my-table").Tabledit({columns:{identifier:[0,"id"],editable:[[1,"col1"],[2,"col1"],[3,"col3"]]}}),$("#mainTable").editableTableWidget().numericInputExample().find("td:first").focus()});